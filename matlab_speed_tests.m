function matlab_speed_tests
    clc

    for i = 1:7
        if i ~= 1
            fprintf('\n');
        end
        
        fprintf('---[Run #%d]---\n', i);
        fprintf('\n');

        testModel('Bondarenko et al. 2004', ...
                  @bondarenko_szigeti_bett_kim_rasmusson_2004_apical, ...
                  0:1:10000, ... % In milliseconds
                  [0.124216e-3, 0.578679e-8, 0.119816e-12, 0.497923e-18, 0.345847e-13, 0.185106e-13, 0.930308e-18, 125.29, 11.2684, 1299.5, 1299.5, 0.115001, 0.115001, 0.0, 0.279132e-3, 0.020752, 0.673345e-6, 0.155787e-8, 0.0113879, 0.34278, 0.153176e-3, 0.713483e-6, 0.265563e-2, 0.999977, -82.4202, 0.417069e-3, 1.0, 143720.0, 0.992513e-3, 0.641229e-3, 0.319129e-4, 0.175298e-3, 0.16774e-3, 0.149102e-4, 0.951726e-10, 0.262753e-3, 0.417069e-3, 0.998543, 14237.1, 0.417069e-3, 0.998543], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7, 'MaxStep', 0.5));

        testModel('Courtemanche et al. 1998', ...
                  @courtemanche_ramirez_nattel_1998, ...
                  0:1:100000, ... % In milliseconds
                  [2.35e-112, 1.0, 0.9992, 1.367e-4, 7.755e-1, 9.996e-1, 9.649e-1, 9.775e-1, 2.908e-3, 1.013e-4, 1.488, 1.488, 1.39e2, 1.117e1, -81.18, 3.296e-5, 1.869e-2, 3.043e-2, 9.992e-1, 4.966e-3, 9.986e-1], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7, 'MaxStep', 2));

        testModel('Faber & Rudy 2000', ...
                  @faber_rudy_2000, ...
                  0:1:50000, ... % In milliseconds
                  [5.82597094505446e-6, 0.997765362821995, 0.00136737866785149, 0.98881442877378, 9.65910542308504e-196, 5.33944967562997e-195, 0.000129515197402902, 1.12791401197882, 1.76731003671612, 0.000117482029668194, 2.69380318286645e-196, 0.0, 0.0, 0.0, -85.2119207874627, 0.985596581239651, 0.990898461370389, 0.00149183115674257, 141.056872392446, 13.3649235394859, 0.000204700363126417, 0.00660746743356887, 0.0303768241233812, 0.999945568566232, 0.0144622472219576], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7, 'MaxStep', 2));

        testModel('Garny et al. 2003', ...
                  @garny_kohl_hunter_boyett_noble_2003, ...
                  0:0.001:100, ... % In seconds
                  [0.04804900895, 0.48779845203, 0.42074047435, 0.038968420558, 0.29760539675, 0.064402950262, 0.03889291759, -39.013558536, 0.13034201158, 0.46960956028, 0.87993375273, 0.082293827208, 0.015905380261, 0.01445216109, 0.092361701692], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7));

        testModel('Luo & Rudy 1991', ...
                  @luo_rudy_1991, ...
                  0:1:200000, ... % In milliseconds
                  [0.982660523699656, 0.989108212766685, 0.00171338077730188, 0.00017948816388306, -84.3801107371, 0.00302126301779861, 0.999967936476325, 0.0417603108167287], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7, 'MaxStep', 2));

        testModel('Noble 1962', ...
                  @noble_1962, ...
                  0:0.001:1000, ... % In seconds
                  [-87.0, 0.01, 0.8, 0.01], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7));

        testModel('Noble et al. 1998', ...
                  @noble_varghese_kohl_noble_1998_a, ...
                  0:0.001:100, ... % In seconds
                  [0.0, 0.9349197, 0.9651958, 1.0, 0.0042614, 0.4068154, 0.9944036, 0.0016203, 0.0005555, 0.0003542, 1.88e-5, 1.4e-5, 0.4481927, 0.4531889, 136.5644281, 7.3321223, -92.849333, 1.03e-5, 2.0e-7, 0.001302, 0.0, 0.9948645], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7, 'MaxStep', 0.003));

        testModel('Nygren et al. 1998', ...
                  @nygren_fiset_firek_clark_lindblad_clark_giles_1998, ...
                  0:0.001:100, ... % In seconds
                  [0.6465, 0.6646, 0.4284, 0.0028, 0.4369, 0.0010678, 0.949, 1.3005e-5, 0.9986, 0.9986, 1.8147, 5.3581, 130.011, 0.0048357, 0.0001, 0.0275, 0.0133, 0.1961, 0.7094, 7.2495e-5, 6.729e-5, 129.435, 8.5547, -74.2525, 0.8814, 0.8742, 0.0032017, 0.00015949, 0.9912], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7, 'MaxStep', 0.006));

        testModel('ten Tusscher & Panfilov 2006', ...
                  @ten_tusscher_model_2006_IK1Ko_epi_units, ...
                  0:1:100000, ... % In milliseconds
                  [3.373e-5, 0.9755, 0.9953, 0.7888, 3.64, 0.000126, 0.00036, 0.9073, 0.7444, 0.7045, 0.00172, -85.23, 136.89, 0.00621, 0.4712, 0.0095, 8.604, 2.42e-8, 0.999998], ...
                  odeset('RelTol', 1e-7, 'AbsTol', 1e-7, 'MaxStep', 1));
    end
end

function testModel(modelName, rhs, tSpan, y, options)
    startingtime = cputime;

    [tData, yData] = ode15s(rhs, tSpan, y, options);

    fprintf('%s:%s%f s\n', modelName, repmat(sprintf(' '), 1, 30-size(modelName, 2)), cputime-startingtime);
end
